plugins {
  id 'nf-sqldb@0.2.0'
}

params.oldeventpath = "/lb/robot/research/processing/events/system/202[12]/*/*_samples*.txt"
params.novaseqflagfiles = "/nb/Research/Novaseq/*/SequenceComplete.txt"

profiles {
  production {
    workDir = "/lb/scratch/freezeman-lims/work"
    params {
      db = "/nb/Research/freezeman-processing/monitor.db"
      email {
        onstart = 'jean-michel.garant@computationalgenomics.ca,mareike.janiak@computationalgenomics.ca,jose.hector.galvez@computationalgenomics.ca,edouard.henrion@computationalgenomics.ca'
        onfinish = 'jean-michel.garant@computationalgenomics.ca,mareike.janiak@computationalgenomics.ca,jose.hector.galvez@computationalgenomics.ca,edouard.henrion@computationalgenomics.ca,janick.st-cyr@mcgill.ca,marlon.amersi@mcgill.ca,lena.lichunfong@mcgill.ca,haig.djambazian@mcgill.ca,ulysse.fortiergauthier@mcgill.ca'
      }
      emailoncrash = true
      ingest = "https://biobank.genome.mcgill.ca/api/"
      neweventpath = "/lb/robot/research/processing/events/*.txt"
      newruninfopath = "/nb/home/freezeman-lims/freezeman-lims-run-info/*.json"
      commit = 'run_processing'
      genpipes = '${projectDir}/genpipes'
      sendmail = true
      custom_ini = "${projectDir}/assets/production.ini"
      illumina {
        outdir = '/nb/Research/freezeman-processing'
        miseq = '/nb/Research/Miseq/*/RTAComplete.txt'
        hiseqx = '/nb/Research/hiseqX/*/RTAComplete.txt'
        novaseq = '/nb/Research/Novaseq/*/RTAComplete.txt'
        iseq1 = '/nb/Research/iSeq/RUNS/*/RTAComplete.txt'
        iseq2 = '/nb/Research/iSeq/RUNS/atlasfs/researchISeq/RUNS/*/RTAComplete.txt'
      }
      mgi {
        outdir = '/nb/Research/freezeman-processing'
        g400 {
          success = "/nb/Research/MGISeq/seq[12]/R213040019001[68]/*/*_Success.txt"
        }
        t7 {
          flags = "/nb/Research/MGISeq/T7/*/flag"
          demux = true
        }
      }
      sftpssharbutus = "/nb/home/freezeman-lims/.ssh/arbutus_uds_id_rsa"
    }
  }

  debug {
    workDir = "/lb/scratch/freezeman-qc/work"
    params {
      db = "/nb/home/freezeman-qc/rp_test/debug.db"
      email {
        onstart = 'jean-michel.garant@computationalgenomics.ca'
        onfinish = 'jean-michel.garant@computationalgenomics.ca'
      }
      emailoncrash = true
      ingest = "https://f5kvm-biobank-qc.genome.mcgill.ca/api/"
      neweventpath = "/lb/robot/research/processing/events/*.txt"
      newruninfopath = "/nb/home/freezeman-qc/freezeman-lims-run-info/*.json"
      commit = 'run_processing'
      genpipes = "${projectDir}/genpipes"
      sendmail = true
      custom_ini = "${projectDir}/assets/debug.ini"
      illumina {
        outdir = '/nb/home/freezeman-qc/rp_test'
        miseq = '/nb/Research/Miseq/2[3456789]*/RTAComplete.txt'
//        hiseqx = '/nb/Research/hiseqX/2[3456789]*/RTAComplete.txt'
        novaseq = '/nb/Research/Novaseq/2[3456789]*/RTAComplete.txt'
//        iseq1 = '/nb/Research/iSeq/RUNS/202[3456789]*/RTAComplete.txt'
//        iseq2 = '/nb/Research/iSeq/RUNS/atlasfs/researchISeq/RUNS/202[3456789]*/RTAComplete.txt'
      }
      mgi {
        outdir = '/nb/home/freezeman-qc/rp_test'
        g400 {
          success = "/nb/Research/MGISeq/seq[12]/R213040019001[68]/*/*_Success.txt"
        }
        t7 {
          flags = "/nb/Research/MGISeq/T7/*/flag"
          demux = true
        }
      }
      sftpssharbutus = "/nb/home/freezeman-qc/.ssh/arbutus_uds_id_rsa"
    }
  }

  dev {
    workDir = "/lb/scratch/freezeman-qc/work"
    params {
      db = "processing.dev.db"
      email {
        onstart = 'jean-michel.garant@computationalgenomics.ca,edouard.henrion@computationalgenomics.ca'
        onfinish = 'jean-michel.garant@computationalgenomics.ca,edouard.henrion@computationalgenomics.ca'
      }
      emailoncrash = false
      ingest = "https://f5kvm-biobank-qc.genome.mcgill.ca/api/"
      neweventpath = "${projectDir}/assets/testing/events/*.txt"
      newruninfopath = "/home/freezeman-dev/freezeman-lims-run-info/*.json"
      commit = 'run_processing'
      genpipes = "${projectDir}/genpipes"
      sendmail = true
      custom_ini = "${projectDir}/assets/dev.ini"
      illumina {
        outdir = '/nb/home/freezeman-qc/rp_test'
        miseq = '/nb/Research/Miseq/*/RTAComplete.txt'
        hiseqx = '/nb/Research/hiseqX/*/RTAComplete.txt'
        novaseq = '/nb/Research/Novaseq/*/RTAComplete.txt'
        iseq1 = '/nb/Research/iSeq/RUNS/*/RTAComplete.txt'
        iseq2 = '/nb/Research/iSeq/RUNS/atlasfs/researchISeq/RUNS/*/RTAComplete.txt'
      }
      mgi {
        outdir = '/nb/home/freezeman-dev/rp_test'
        g400 {
          success = "/nb/Research/MGISeq/seq[12]/R213040019001[68]/*/*_Success.txt"
        }
        t7 {
          flags = "${projectDir}/assets/testing/flags"
          demux = true
        }
      }
    }
  }
}

manifest {
    name = "C3G run processing monitor"
    description = "Background process that monitor and/or launch the run\
    processing of samples on the Abacus cluster."
    version = "0.0.3"
    homePage = "https://github.com/c3g/monitor"
    defaultBranch = "main"
    recurseSubmodules = true
    nextflowVersion = ">=20.07.1-edge"
    author = "Jean-Michel Garant, Ã‰douard Henrion, Robert Syme"
}
